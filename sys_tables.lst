     1                                  GLOBAL _PAGE_DIRECTORY, _PAGE_TABLE , GDT_INI ,SEL_CS ,SEL_DATOS ,SEL_CS_USER ,SEL_DATOS_USER ,IDT_INI ,GDTR ,IDTR , _PAGE_TABLE_PF , _TSS1, _TSS2, _TSS3, _TSS_kernel , TSS_kernel_index
     2                                  GLOBAL TSS1, TSS2, TSS3
     3                                  
     4                                  GLOBAL _TSS1_XMM0, _TSS1_XMM1, _TSS2_XMM0, _TSS2_XMM1, _TSS3_XMM0, _TSS3_XMM1
     5                                  
     6                                  
     7                                  [section .data]
     8                                  CANTIDAD_INT 	equ 128
     9                                  __SECT__
    10                                  
    11                                  
    12                                  ;********************************************************************************
    13                                  ;* DATA																		 	*
    14                                  ;********************************************************************************
    15                                  [section .tablas]
    16                                  align 4096
    17                                  _PAGE_DIRECTORY:
    18 00000000 00000000<rept>               times 1024 dd 0 
    19                                  
    20                                  _PAGE_TABLE:
    21 00001000 00000000<rept>               times 1024 dd 0 
    22                                  
    23                                  _PAGE_TABLE_PF:
    24 00002000 00000000<rept>               times 1024 dd 0
    25                                       ;considerar reservar mas para los #PF
    26                                  
    27                                       
    28                                     
    29                                  __SECT__
    30                                  
    31                                  [section .gdt_idt]
    32                                  align 4
    33                                  _TSS_kernel:
    34                                  
    35 00000000 00000000<rept>              times 26 dd 0;
    36                                  
    37                                  _TSS1:
    38 00000068 00000000<rept>              times 26 dd 0;
    39                                      
    40                                  _TSS2:
    41 000000D0 00000000<rept>              times 26 dd 0;
    42                                      
    43                                  _TSS3:
    44 00000138 00000000<rept>              times 26 dd 0;
    45                                  ;los registros XMM usare solo el xmm0 y el xmm2
    46                                  align 16
    47                                  _TSS1_XMM0:
    48 000001A0 04000000                	dd 4    ;xmmm0
    49 000001A4 90<rept>                align 16	
    50                                  _TSS1_XMM1:
    51 000001B0 04000000                	dd 4    ;xmmm1
    52 000001B4 90<rept>                align 16	
    53                                  _TSS2_XMM0:
    54 000001C0 04000000                	dd 4    ;xmmm0
    55 000001C4 90<rept>                align 16	
    56                                  _TSS2_XMM1:
    57 000001D0 04000000                	dd 4    ;xmmm1
    58 000001D4 90<rept>                align 16	
    59                                  _TSS3_XMM0:
    60 000001E0 04000000                	dd 4    ;xmmm0
    61 000001E4 90<rept>                align 16	
    62                                  _TSS3_XMM1:
    63 000001F0 04000000                	dd 4    ;xmmm1
    64                                  	  
    65                                  
    66 000001F4 90<rept>                align 8
    67 000001F8 0000000000000000        dq 0
    68                                  GDT_INI: 
    69 00000200 0000000000000000            dq 0
    70                                      SEL_CS EQU $ - GDT_INI 
    71 00000208 0000000000000000            dq 0
    72                                      SEL_DATOS EQU $ - GDT_INI 
    73 00000210 0000000000000000            dq 0
    74                                      SEL_CS_USER EQU $ - GDT_INI 
    75 00000218 0000000000000000            dq 0
    76                                      SEL_DATOS_USER EQU $ - GDT_INI 
    77 00000220 0000000000000000            dq 0
    78                                      TSS_kernel_index EQU $ - GDT_INI 
    79 00000228 0000000000000000            dq 0
    80                                      TSS1 EQU $ - GDT_INI 
    81 00000230 0000000000000000            dq 0
    82                                      TSS2 EQU $ - GDT_INI 
    83 00000238 0000000000000000            dq 0
    84                                      TSS3 EQU $ - GDT_INI 
    85 00000240 0000000000000000            dq 0
    86                                  GDT_LIM EQU $ - GDT_INI     ;obtengo el limite: direccion actual - inicio
    87                                  
    88                                  align 8
    89 00000248 0000000000000000        dq 0
    90                                  IDT_INI:
    91                                  %rep CANTIDAD_INT
    92                                      dq 0
    93                                      dq 0
    94                                  %endrep
    95 00000250 0000000000000000    <1>  dq 0
    96 00000258 0000000000000000    <1>  dq 0
    97 00000260 0000000000000000    <1>  dq 0
    98 00000268 0000000000000000    <1>  dq 0
    99 00000270 0000000000000000    <1>  dq 0
   100 00000278 0000000000000000    <1>  dq 0
   101 00000280 0000000000000000    <1>  dq 0
   102 00000288 0000000000000000    <1>  dq 0
   103 00000290 0000000000000000    <1>  dq 0
   104 00000298 0000000000000000    <1>  dq 0
   105 000002A0 0000000000000000    <1>  dq 0
   106 000002A8 0000000000000000    <1>  dq 0
   107 000002B0 0000000000000000    <1>  dq 0
   108 000002B8 0000000000000000    <1>  dq 0
   109 000002C0 0000000000000000    <1>  dq 0
   110 000002C8 0000000000000000    <1>  dq 0
   111 000002D0 0000000000000000    <1>  dq 0
   112 000002D8 0000000000000000    <1>  dq 0
   113 000002E0 0000000000000000    <1>  dq 0
   114 000002E8 0000000000000000    <1>  dq 0
   115 000002F0 0000000000000000    <1>  dq 0
   116 000002F8 0000000000000000    <1>  dq 0
   117 00000300 0000000000000000    <1>  dq 0
   118 00000308 0000000000000000    <1>  dq 0
   119 00000310 0000000000000000    <1>  dq 0
   120 00000318 0000000000000000    <1>  dq 0
   121 00000320 0000000000000000    <1>  dq 0
   122 00000328 0000000000000000    <1>  dq 0
   123 00000330 0000000000000000    <1>  dq 0
   124 00000338 0000000000000000    <1>  dq 0
   125 00000340 0000000000000000    <1>  dq 0
   126 00000348 0000000000000000    <1>  dq 0
   127 00000350 0000000000000000    <1>  dq 0
   128 00000358 0000000000000000    <1>  dq 0
   129 00000360 0000000000000000    <1>  dq 0
   130 00000368 0000000000000000    <1>  dq 0
   131 00000370 0000000000000000    <1>  dq 0
   132 00000378 0000000000000000    <1>  dq 0
   133 00000380 0000000000000000    <1>  dq 0
   134 00000388 0000000000000000    <1>  dq 0
   135 00000390 0000000000000000    <1>  dq 0
   136 00000398 0000000000000000    <1>  dq 0
   137 000003A0 0000000000000000    <1>  dq 0
   138 000003A8 0000000000000000    <1>  dq 0
   139 000003B0 0000000000000000    <1>  dq 0
   140 000003B8 0000000000000000    <1>  dq 0
   141 000003C0 0000000000000000    <1>  dq 0
   142 000003C8 0000000000000000    <1>  dq 0
   143 000003D0 0000000000000000    <1>  dq 0
   144 000003D8 0000000000000000    <1>  dq 0
   145 000003E0 0000000000000000    <1>  dq 0
   146 000003E8 0000000000000000    <1>  dq 0
   147 000003F0 0000000000000000    <1>  dq 0
   148 000003F8 0000000000000000    <1>  dq 0
   149 00000400 0000000000000000    <1>  dq 0
   150 00000408 0000000000000000    <1>  dq 0
   151 00000410 0000000000000000    <1>  dq 0
   152 00000418 0000000000000000    <1>  dq 0
   153 00000420 0000000000000000    <1>  dq 0
   154 00000428 0000000000000000    <1>  dq 0
   155 00000430 0000000000000000    <1>  dq 0
   156 00000438 0000000000000000    <1>  dq 0
   157 00000440 0000000000000000    <1>  dq 0
   158 00000448 0000000000000000    <1>  dq 0
   159 00000450 0000000000000000    <1>  dq 0
   160 00000458 0000000000000000    <1>  dq 0
   161 00000460 0000000000000000    <1>  dq 0
   162 00000468 0000000000000000    <1>  dq 0
   163 00000470 0000000000000000    <1>  dq 0
   164 00000478 0000000000000000    <1>  dq 0
   165 00000480 0000000000000000    <1>  dq 0
   166 00000488 0000000000000000    <1>  dq 0
   167 00000490 0000000000000000    <1>  dq 0
   168 00000498 0000000000000000    <1>  dq 0
   169 000004A0 0000000000000000    <1>  dq 0
   170 000004A8 0000000000000000    <1>  dq 0
   171 000004B0 0000000000000000    <1>  dq 0
   172 000004B8 0000000000000000    <1>  dq 0
   173 000004C0 0000000000000000    <1>  dq 0
   174 000004C8 0000000000000000    <1>  dq 0
   175 000004D0 0000000000000000    <1>  dq 0
   176 000004D8 0000000000000000    <1>  dq 0
   177 000004E0 0000000000000000    <1>  dq 0
   178 000004E8 0000000000000000    <1>  dq 0
   179 000004F0 0000000000000000    <1>  dq 0
   180 000004F8 0000000000000000    <1>  dq 0
   181 00000500 0000000000000000    <1>  dq 0
   182 00000508 0000000000000000    <1>  dq 0
   183 00000510 0000000000000000    <1>  dq 0
   184 00000518 0000000000000000    <1>  dq 0
   185 00000520 0000000000000000    <1>  dq 0
   186 00000528 0000000000000000    <1>  dq 0
   187 00000530 0000000000000000    <1>  dq 0
   188 00000538 0000000000000000    <1>  dq 0
   189 00000540 0000000000000000    <1>  dq 0
   190 00000548 0000000000000000    <1>  dq 0
   191 00000550 0000000000000000    <1>  dq 0
   192 00000558 0000000000000000    <1>  dq 0
   193 00000560 0000000000000000    <1>  dq 0
   194 00000568 0000000000000000    <1>  dq 0
   195 00000570 0000000000000000    <1>  dq 0
   196 00000578 0000000000000000    <1>  dq 0
   197 00000580 0000000000000000    <1>  dq 0
   198 00000588 0000000000000000    <1>  dq 0
   199 00000590 0000000000000000    <1>  dq 0
   200 00000598 0000000000000000    <1>  dq 0
   201 000005A0 0000000000000000    <1>  dq 0
   202 000005A8 0000000000000000    <1>  dq 0
   203 000005B0 0000000000000000    <1>  dq 0
   204 000005B8 0000000000000000    <1>  dq 0
   205 000005C0 0000000000000000    <1>  dq 0
   206 000005C8 0000000000000000    <1>  dq 0
   207 000005D0 0000000000000000    <1>  dq 0
   208 000005D8 0000000000000000    <1>  dq 0
   209 000005E0 0000000000000000    <1>  dq 0
   210 000005E8 0000000000000000    <1>  dq 0
   211 000005F0 0000000000000000    <1>  dq 0
   212 000005F8 0000000000000000    <1>  dq 0
   213 00000600 0000000000000000    <1>  dq 0
   214 00000608 0000000000000000    <1>  dq 0
   215 00000610 0000000000000000    <1>  dq 0
   216 00000618 0000000000000000    <1>  dq 0
   217 00000620 0000000000000000    <1>  dq 0
   218 00000628 0000000000000000    <1>  dq 0
   219 00000630 0000000000000000    <1>  dq 0
   220 00000638 0000000000000000    <1>  dq 0
   221 00000640 0000000000000000    <1>  dq 0
   222 00000648 0000000000000000    <1>  dq 0
   223 00000650 0000000000000000    <1>  dq 0
   224 00000658 0000000000000000    <1>  dq 0
   225 00000660 0000000000000000    <1>  dq 0
   226 00000668 0000000000000000    <1>  dq 0
   227 00000670 0000000000000000    <1>  dq 0
   228 00000678 0000000000000000    <1>  dq 0
   229 00000680 0000000000000000    <1>  dq 0
   230 00000688 0000000000000000    <1>  dq 0
   231 00000690 0000000000000000    <1>  dq 0
   232 00000698 0000000000000000    <1>  dq 0
   233 000006A0 0000000000000000    <1>  dq 0
   234 000006A8 0000000000000000    <1>  dq 0
   235 000006B0 0000000000000000    <1>  dq 0
   236 000006B8 0000000000000000    <1>  dq 0
   237 000006C0 0000000000000000    <1>  dq 0
   238 000006C8 0000000000000000    <1>  dq 0
   239 000006D0 0000000000000000    <1>  dq 0
   240 000006D8 0000000000000000    <1>  dq 0
   241 000006E0 0000000000000000    <1>  dq 0
   242 000006E8 0000000000000000    <1>  dq 0
   243 000006F0 0000000000000000    <1>  dq 0
   244 000006F8 0000000000000000    <1>  dq 0
   245 00000700 0000000000000000    <1>  dq 0
   246 00000708 0000000000000000    <1>  dq 0
   247 00000710 0000000000000000    <1>  dq 0
   248 00000718 0000000000000000    <1>  dq 0
   249 00000720 0000000000000000    <1>  dq 0
   250 00000728 0000000000000000    <1>  dq 0
   251 00000730 0000000000000000    <1>  dq 0
   252 00000738 0000000000000000    <1>  dq 0
   253 00000740 0000000000000000    <1>  dq 0
   254 00000748 0000000000000000    <1>  dq 0
   255 00000750 0000000000000000    <1>  dq 0
   256 00000758 0000000000000000    <1>  dq 0
   257 00000760 0000000000000000    <1>  dq 0
   258 00000768 0000000000000000    <1>  dq 0
   259 00000770 0000000000000000    <1>  dq 0
   260 00000778 0000000000000000    <1>  dq 0
   261 00000780 0000000000000000    <1>  dq 0
   262 00000788 0000000000000000    <1>  dq 0
   263 00000790 0000000000000000    <1>  dq 0
   264 00000798 0000000000000000    <1>  dq 0
   265 000007A0 0000000000000000    <1>  dq 0
   266 000007A8 0000000000000000    <1>  dq 0
   267 000007B0 0000000000000000    <1>  dq 0
   268 000007B8 0000000000000000    <1>  dq 0
   269 000007C0 0000000000000000    <1>  dq 0
   270 000007C8 0000000000000000    <1>  dq 0
   271 000007D0 0000000000000000    <1>  dq 0
   272 000007D8 0000000000000000    <1>  dq 0
   273 000007E0 0000000000000000    <1>  dq 0
   274 000007E8 0000000000000000    <1>  dq 0
   275 000007F0 0000000000000000    <1>  dq 0
   276 000007F8 0000000000000000    <1>  dq 0
   277 00000800 0000000000000000    <1>  dq 0
   278 00000808 0000000000000000    <1>  dq 0
   279 00000810 0000000000000000    <1>  dq 0
   280 00000818 0000000000000000    <1>  dq 0
   281 00000820 0000000000000000    <1>  dq 0
   282 00000828 0000000000000000    <1>  dq 0
   283 00000830 0000000000000000    <1>  dq 0
   284 00000838 0000000000000000    <1>  dq 0
   285 00000840 0000000000000000    <1>  dq 0
   286 00000848 0000000000000000    <1>  dq 0
   287 00000850 0000000000000000    <1>  dq 0
   288 00000858 0000000000000000    <1>  dq 0
   289 00000860 0000000000000000    <1>  dq 0
   290 00000868 0000000000000000    <1>  dq 0
   291 00000870 0000000000000000    <1>  dq 0
   292 00000878 0000000000000000    <1>  dq 0
   293 00000880 0000000000000000    <1>  dq 0
   294 00000888 0000000000000000    <1>  dq 0
   295 00000890 0000000000000000    <1>  dq 0
   296 00000898 0000000000000000    <1>  dq 0
   297 000008A0 0000000000000000    <1>  dq 0
   298 000008A8 0000000000000000    <1>  dq 0
   299 000008B0 0000000000000000    <1>  dq 0
   300 000008B8 0000000000000000    <1>  dq 0
   301 000008C0 0000000000000000    <1>  dq 0
   302 000008C8 0000000000000000    <1>  dq 0
   303 000008D0 0000000000000000    <1>  dq 0
   304 000008D8 0000000000000000    <1>  dq 0
   305 000008E0 0000000000000000    <1>  dq 0
   306 000008E8 0000000000000000    <1>  dq 0
   307 000008F0 0000000000000000    <1>  dq 0
   308 000008F8 0000000000000000    <1>  dq 0
   309 00000900 0000000000000000    <1>  dq 0
   310 00000908 0000000000000000    <1>  dq 0
   311 00000910 0000000000000000    <1>  dq 0
   312 00000918 0000000000000000    <1>  dq 0
   313 00000920 0000000000000000    <1>  dq 0
   314 00000928 0000000000000000    <1>  dq 0
   315 00000930 0000000000000000    <1>  dq 0
   316 00000938 0000000000000000    <1>  dq 0
   317 00000940 0000000000000000    <1>  dq 0
   318 00000948 0000000000000000    <1>  dq 0
   319 00000950 0000000000000000    <1>  dq 0
   320 00000958 0000000000000000    <1>  dq 0
   321 00000960 0000000000000000    <1>  dq 0
   322 00000968 0000000000000000    <1>  dq 0
   323 00000970 0000000000000000    <1>  dq 0
   324 00000978 0000000000000000    <1>  dq 0
   325 00000980 0000000000000000    <1>  dq 0
   326 00000988 0000000000000000    <1>  dq 0
   327 00000990 0000000000000000    <1>  dq 0
   328 00000998 0000000000000000    <1>  dq 0
   329 000009A0 0000000000000000    <1>  dq 0
   330 000009A8 0000000000000000    <1>  dq 0
   331 000009B0 0000000000000000    <1>  dq 0
   332 000009B8 0000000000000000    <1>  dq 0
   333 000009C0 0000000000000000    <1>  dq 0
   334 000009C8 0000000000000000    <1>  dq 0
   335 000009D0 0000000000000000    <1>  dq 0
   336 000009D8 0000000000000000    <1>  dq 0
   337 000009E0 0000000000000000    <1>  dq 0
   338 000009E8 0000000000000000    <1>  dq 0
   339 000009F0 0000000000000000    <1>  dq 0
   340 000009F8 0000000000000000    <1>  dq 0
   341 00000A00 0000000000000000    <1>  dq 0
   342 00000A08 0000000000000000    <1>  dq 0
   343 00000A10 0000000000000000    <1>  dq 0
   344 00000A18 0000000000000000    <1>  dq 0
   345 00000A20 0000000000000000    <1>  dq 0
   346 00000A28 0000000000000000    <1>  dq 0
   347 00000A30 0000000000000000    <1>  dq 0
   348 00000A38 0000000000000000    <1>  dq 0
   349 00000A40 0000000000000000    <1>  dq 0
   350 00000A48 0000000000000000    <1>  dq 0
   351                                  
   352                                  IDT_LIM EQU $ - IDT_INI     ;obtengo el limite: direccion actual - inicio
   353                                  
   354                                  align 4
   355 00000A50 0000                    dw 0
   356                                  GDTR:
   357 00000A52 4800                       dw GDT_LIM
   358 00000A54 [00020000]                 dd GDT_INI
   359                                  
   360                                  align 4
   361 00000A58 0000                    dw 0
   362                                  IDTR:
   363 00000A5A 0008                       dw IDT_LIM
   364 00000A5C [50020000]                 dd IDT_INI
   365                                  __SECT__
